<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Jekyll Post Editor v2.0</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; line-height: 1.6; background-color: #f4f7f9; color: #333; margin: 0; padding: 20px; }
        .editor-container { max-width: 900px; margin: 0 auto; background: #fff; padding: 25px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #2c3e50; border-bottom: 2px solid #ecf0f1; padding-bottom: 10px; }
        fieldset { border: 1px solid #ddd; border-radius: 5px; padding: 20px; margin-bottom: 25px; }
        legend { font-weight: bold; font-size: 1.2em; color: #34495e; padding: 0 10px; }
        .form-group { margin-bottom: 20px; }
        .form-group-inline { display: flex; align-items: center; gap: 10px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; color: #555; }
        input[type="text"] { flex-grow: 1; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-size: 1em; }
        textarea { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-size: 1em; min-height: 300px; resize: vertical; }
        .toolbar { margin-bottom: 10px; background: #ecf0f1; padding: 8px; border-radius: 4px; display: flex; flex-wrap: wrap; gap: 8px; }
        .toolbar button { background: #3498db; color: #fff; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-weight: bold; transition: background 0.2s; }
        .toolbar button:hover { background: #2980b9; }
        .generate-btn { background: #2ecc71; color: #fff; border: none; padding: 12px 20px; border-radius: 4px; cursor: pointer; font-size: 1.1em; font-weight: bold; display: block; width: 100%; margin-top: 20px; transition: background 0.2s; }
        .generate-btn:hover { background: #27ae60; }
        .copy-btn { background: #95a5a6; padding: 6px 12px; font-size: 0.9em; }
        .copy-btn:hover { background: #7f8c8d; }
        #output { min-height: 400px; background: #2c3e50; color: #ecf0f1; font-family: "Courier New", Courier, monospace; white-space: pre; overflow-wrap: break-word; }
        .info { font-size: 0.9em; color: #777; background: #e8f4fd; padding: 10px; border-radius: 4px; border-left: 4px solid #3498db; margin-top: 5px; }
    </style>
</head>
<body>

<div class="editor-container">
    <h1>Jekyll Post Editor v2.0</h1>

    <fieldset>
        <legend>1. Metadata Postingan</legend>
        <div class="form-group">
            <label for="title">Judul Postingan</label>
            <input type="text" id="title" placeholder="5 Tips SEO Fundamental untuk Pemula...">
        </div>
        <div class="form-group">
            <label for="filename">Nama File (Otomatis)</label>
            <div class="form-group-inline">
                <input type="text" id="filename" readonly style="background:#eee;">
                <button class="toolbar button copy-btn" onclick="copyToClipboard('filename', this)">Copy Nama File</button>
            </div>
            <p class="info">Gunakan nama file ini saat membuat file baru di folder <code>_posts</code> GitHub Anda.</p>
        </div>
        <div class="form-group">
            <label for="description">Deskripsi (untuk SEO, max 160 karakter)</label>
            <input type="text" id="description" placeholder="Pelajari 5 tips SEO fundamental yang wajib diketahui...">
        </div>
        <div class="form-group">
            <label for="image">Path Gambar Unggulan</label>
            <input type="text" id="image" placeholder="/assets/images/nama-gambar-anda.jpg">
            <p class="info"><strong>Penting:</strong> Anda harus mengunggah gambar ini secara manual ke folder <code>/assets/images/</code> di GitHub Anda.</p>
        </div>
    </fieldset>

    <fieldset>
        <legend>2. Konten Artikel</legend>
        <div class="toolbar">
            <button onclick="addTag('## ')">H2</button>
            <button onclick="addTag('### ')">H3</button>
            <button onclick="addTag('**')">Bold</button>
            <button onclick="addTag('*')">Italic</button>
            <button onclick="addTag('> ')">Quote</button>
            <button onclick="addTag('* ')">List</button>
            <button onclick="addLink()">Link</button>
            <button onclick="addImage()">Sisipkan Gambar</button>
            <button onclick="addCodeBlock()">Code Block</button>
            <button onclick="addAd()">Sisipkan Iklan</button>
        </div>
        <textarea id="content" placeholder="Tulis artikel Anda di sini..."></textarea>
    </fieldset>

    <button class="generate-btn" onclick="generateRawCode()">Buat Kode Raw Postingan</button>

    <fieldset style="margin-top: 25px;">
        <legend style="display:flex; justify-content:space-between; align-items:center; width: 100%;">
            3. Hasil Kode Raw (Siap di Salin)
            <button class="toolbar button copy-btn" onclick="copyToClipboard('output', this)">Copy Semua Kode</button>
        </legend>
        <textarea id="output" readonly></textarea>
    </fieldset>
</div>

<script>
    const titleInput = document.getElementById('title');
    const filenameInput = document.getElementById('filename');
    const contentArea = document.getElementById('content');

    function generateSlug(text) {
        const now = new Date();
        const year = now.getFullYear();
        const month = String(now.getMonth() + 1).padStart(2, '0');
        const day = String(now.getDate()).padStart(2, '0');
        
        const slug = text.toString().toLowerCase()
            .replace(/\s+/g, '-')           // Ganti spasi dengan -
            .replace(/[^\w\-]+/g, '')       // Hapus karakter aneh
            .replace(/\-\-+/g, '-')         // Ganti -- dengan -
            .replace(/^-+/, '')             // Hapus - dari awal
            .replace(/-+$/, '');            // Hapus - dari akhir
            
        return `${year}-${month}-${day}-${slug}.md`;
    }

    titleInput.addEventListener('input', () => {
        filenameInput.value = generateSlug(titleInput.value);
    });

    function addTag(tag, endTag = null) {
        const start = contentArea.selectionStart;
        const end = contentArea.selectionEnd;
        const selectedText = contentArea.value.substring(start, end);
        let replacement;
        
        endTag = endTag || tag; // If endTag is not provided, use the start tag

        if (tag === '**' || tag === '*') { // Wrap selected text
            replacement = tag + selectedText + endTag;
        } else { // Prepend tag to line
            replacement = tag + selectedText;
        }
        
        contentArea.value = contentArea.value.substring(0, start) + replacement + contentArea.value.substring(end);
        contentArea.focus();
        contentArea.selectionEnd = start + replacement.length;
    }

    function addLink() {
        const url = prompt("Masukkan URL:", "https://");
        if (url) {
            const selectedText = contentArea.value.substring(contentArea.selectionStart, contentArea.selectionEnd) || "teks link";
            addTag(`[${selectedText}](`, `${url})`);
        }
    }
    
    function addImage() {
        const path = prompt("Masukkan path gambar:", "/assets/images/nama-gambar.jpg");
        if (path) {
            const alt = prompt("Masukkan deskripsi gambar (alt text):", "deskripsi gambar");
            const replacement = `\n![${alt}](${path})\n`;
            contentArea.value += replacement;
            contentArea.focus();
        }
    }

    function addCodeBlock() {
        const lang = prompt("Masukkan bahasa pemrograman (cth: html, css, js, python):", "javascript");
        if (lang !== null) {
            const selectedText = contentArea.value.substring(contentArea.selectionStart, contentArea.selectionEnd) || "// kode Anda di sini";
            const replacement = `\n\`\`\`${lang}\n${selectedText}\n\`\`\`\n`;
            contentArea.value += replacement;
            contentArea.focus();
        }
    }

    function addAd() {
        const replacement = `\n\n{% include ad-middle.html %}\n\n`;
        contentArea.value += replacement;
        contentArea.focus();
    }

    function generateRawCode() {
        const title = document.getElementById('title').value;
        const description = document.getElementById('description').value;
        const image = document.getElementById('image').value;
        const content = document.getElementById('content').value;
        
        if (!title) {
            alert("Judul postingan tidak boleh kosong!");
            return;
        }
        
        const frontMatter = `---
layout: post
title: "${title.replace(/"/g, '\\"')}"
description: "${description.replace(/"/g, '\\"')}"
image: ${image}
---`;

        const finalCode = `${frontMatter}\n\n${content}`;
        document.getElementById('output').value = finalCode;
        alert("Kode Raw berhasil dibuat di kotak bagian bawah!");
    }

    function copyToClipboard(elementId, button) {
        const element = document.getElementById(elementId);
        if (!element.value) return;
        
        navigator.clipboard.writeText(element.value).then(() => {
            const originalText = button.textContent;
            button.textContent = 'Copied!';
            setTimeout(() => {
                button.textContent = originalText;
            }, 2000);
        }).catch(err => {
            console.error('Gagal menyalin: ', err);
            alert("Gagal menyalin teks.");
        });
    }

</script>

</body>
</html>
